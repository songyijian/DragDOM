"use strict";function getStyle(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle(t,!1)[e]}function getPage(t){for(var e=t.offsetLeft,o=t.offsetTop,n=t.offsetParent;null!=n;)e+=n.offsetLeft+n.clientLeft,o+=n.offsetTop+n.clientTop,n=n.offsetParent;return{x:e,y:o}}var DragDOM=function(){function t(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};1===t.nodeType?(this.elPosition=getStyle(t,"position"),"absolute"===this.elPosition||"fixed"===this.elPosition?(this.el=t,this.parentData=null,this.elData=null,this.moveData=null,this.config={overflow:e.overflow||!1,pUnit:e.pUnit||"px",start:e.start||function(){},drag:e.drag||function(){},end:e.end||function(){}},this.init(this.el)):console.warn("[DragDOM el] position on  absolute | fixed！")):console.warn("[DragDOM el] Is not a valid node ！")}var e=t.prototype;return e.init=function(u){var t,e,o,f=this,c=!1,n=void 0!==u.ontouchstart?"touch":"mouse";function d(t){var e=t||window.event;return"touch"===n?e.touches[0]:e}o="touch"===n?(t="touchstart",e="touchmove","touchend"):(t="mousedown",e="mousemove","mouseup");var g,h,p,v,m,y,D,P,x,w,L,b,T=null;u.addEventListener(t,function(t){var e,o,n,i,l,a,s,r;this.elPosition=getStyle(u,"position"),"absolute"===this.elPosition||"fixed"===this.elPosition?(e=d(t),x=e.pageX,w=e.pageY,y="absolute"===f.elPosition?(o=getPage(T=u.offsetParent),i=(n=T.getBoundingClientRect()).height,l=n.width,D=o.y,P=o.x,m=l,i):(L=document.documentElement.clientWidth,b=document.documentElement.clientHeight,T=document.documentElement,P=D=0,m=L,b),f.parentData={parent:T,parentWidth:m,parentHeight:y,parentTop:D,parentLeft:P},s=(a=u.getBoundingClientRect()).height,r=a.width,p=r,v=s,g=u.offsetTop,h=u.offsetLeft,f.elData={elWidth:p,elHeight:v,elTop:g,elLeft:h},f.moveData=null,c=!0,f.config.start.call(f,t)):console.error("[Drag el] position on  absolute | fixed！")},!1),document.addEventListener(e,function(t){var e,o,n,i,l;c&&(t.preventDefault(),o=(e=d(t)).pageX-x,n=e.pageY-w,i=g+n,l=h+o,"absolute"!==f.elPosition&&"fixed"!==f.elPosition||f.config.overflow||(i<0&&(i=0),l<0&&(l=0),y-v<i&&(i=y-v),m-p<l&&(l=m-p)),!(f.moveData={mx:o,my:n,ely:i,elx:l})!==f.config.drag.call(f,t,f.moveData)&&(u.style.bottom="auto",u.style.right="auto","%"===f.config.pUnit?(u.style.top=i/y*100+"%",u.style.left=l/m*100+"%"):(u.style.top=i+"px",u.style.left=l+"px")))},{passive:!1}),document.addEventListener(o,function(t){c&&(c=!1,f.config.end.call(f,t))},!1)},e.start=function(t){return this.config.start=t,this},e.drag=function(t){return this.config.drag=t,this},e.end=function(t){return this.config.end=t,this},t}();module.exports=DragDOM;
